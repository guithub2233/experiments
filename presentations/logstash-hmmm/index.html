<!-- TODO
  * Kibana stuff?
  * Live demo slot?
  * Horrible log examples for transitions
  -->
<!doctype html>
<html lang="en">

  <head>
    <meta charset="utf-8">

    <title>logstash - hmmm</title>

    <meta name="description" content="logstash">
    <meta name="author" content="Jordan SIssel">

    <meta name="apple-mobile-web-app-capable" content="yes" />
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent" />

    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">

    <link rel="stylesheet" href="css/reveal.min.css">
    <link rel="stylesheet" href="css/theme/default.css" id="theme">

    <!-- For syntax highlighting -->
    <link rel="stylesheet" href="lib/css/zenburn.css">

    <!-- If the query includes 'print-pdf', use the PDF print sheet -->
    <script>
      document.write( '<link rel="stylesheet" href="css/print/' + ( window.location.search.match( /print-pdf/gi ) ? 'pdf' : 'paper' ) + '.css" type="text/css" media="print">' );
    </script>

    <!--[if lt IE 9]>
    <script src="lib/js/html5shiv.js"></script>
    <![endif]-->
    <link rel="stylesheet" href="css/extra.css">
  </head>

  <body>

    <div class="reveal">

      <!-- Any section element inside of this container is displayed as a slide -->
      <div class="slides">

        <section> 
          <img src="images/logstash.png" class="plain full left">
          <div class="right">
            <h2 class="bold">logstash</h2>
            <hr>
            <h4 style="text-align: right"> Jordan Sissel </h4>
            <h4 style="text-align: right"> DreamHost </h4>
          </div>
        </section> 

        <!-- Introduction {{{ ->
        <section data-markdown>
          ## hello!
        </section>
        <!-- }}} -->

        <!-- problems {{{ -->
        <section data-markdown>
          # problems
        </section>

        <section data-markdown>
          ## access

          * Who manages access?
          * How fine-graned are access controls?
          * Who needs access?
        </section>

        <section data-markdown>
          ## consumption

          * who can understand/process the logs?
          * are these the same who need to consume them?
          * have any tools that can process the logs?
        </section>

        <section data-markdown>
          ## curation

          * how long to keep logs?
          * until they fill up disk 
          * ... and crash production
          * ... when you're asleep and on-call.
        </section>

        <section data-markdown>
          ## compliance

          * PCI
          * FISMA
          * Sarbanes-Oxley
          * HIPAA
        </section>

        <section data-markdown>
          ## tooling

          * what helps you do things with logs?
          * search, analyze, report!
          * too specialized (webalizer, etc)
          * don't scale (ssh + grep)
        </section>
        <!-- }}} -->

        <!-- Case Study: DreamHost {{{ -->
        <section>
          <h3 class="text-left"> case study: </h3>
          <h2 class="text-right"> email at DreamHost </h2>
        </section>

        <section>
          <blockquote>
            Help! I'm not getting my mail!
          </blockquote>
          <p class="text-right">- A DreamHost Customer</p>
        </section>

        <section data-markdown>
          ## Why do we care?

          * does this need fixing?
          * what's the business requirement?
        </section>

        <section>
          <h3 class="text-left">A DreamHost Core Value</h3>

          <blockquote class="text-left"> 
            <b>Provide Superhero Service</b>: DreamHost strives to max out the value
            and customer service we put
            into everything we do. 
          </blockquote>
          <i><a href="http://dreamhost.com/about-us/dreamhost-values/">- The DreamHost Way </a></i>
        </section>

        <section>
          <h2> Situation </h2>

          <ul>
            <li class="fragment"> Customer is having email problems,
            <li class="fragment"> and Customers having email problems is bad,
            <li class="fragment"> Logs are necessary for diagnosis,
            <li class="fragment"> so Technical Support needs access,
            <li class="fragment"> but Operations has access,
            <li class="fragment"> and InfoSec policies restrict certain access.
          </ul>
        </section>

        <section data-markdown>
          ## Old Solution

          * access: Ops gives Technical Support ssh access.
          * tooling: scripts ssh+grep hundreds of servers.
          * curation: many GBs of logs per day, per server.
        </section>

        <section data-markdown>
          ## Old Solution

          * problem: grep is slow on gigabytes of data.
          * result: *many minutes* to search today's logs.
          * reduced support efficiency due to bad tooling
        </section>

        <section data-markdown>
          ## Let's Reduce MTTSR
          
          (Mean Time to Technical Support Resolution)
        </section>

        <section data-markdown>
          ## New Solution

          <img src="images/logstash.png" class="plain">
        </section>

        <section data-markdown>
          ## New Solution

          * hundreds of servers ship logs to a logstash cluster
          * provide single search interface on the web

          MAYBE PUT A DIAGRAM HERE :)
        </section>

        <section data-markdown>
          ## results

          * log search results in seconds, not minutes
          * search specific time spans, not just "today" or "yesterday"
          * happier, more effective customer support folks
        </section>

        <section data-markdown>
          ## helps the business

          <blockquote class="text-left"> 
            <b>Empower People</b>: By empowering our employees to be truly
            helpful, we empower our customers with products and services they
            need to do their business.
          </blockquote>
          <i><a href="http://dreamhost.com/about-us/dreamhost-values/">- The DreamHost Way </a></i>
        </section>

        <section>
          <h2> How much improved?</h2>
          <p style="padding-top: 2em" class="text-left">Technical Support Says</p>

          <blockquote class="text-left">by an order of awesome</blockquote>
          <blockquote class="text-left">10000000000%</blockquote>
        </section>

        <section data-markdown>
          ## implementation details
          * /var/log/mail.{info,warn,log}, /var/log/amavisd.log
          * 600-ish servers shipping logs with <a href="https://github.com/jordansissel/lumberjack">lumberjack</a>
          * 7-node logstash/elasticsearch cluster
          * each node: 8 cores, 4TB, 16GB
        </section>

        <section data-markdown>
          ## rough numbers
          * peak 10,000 events/second
          * 500,000,000 events/day
          * 4,000,000,000 events/week
          * 1 terabyte/week
          * peak 10% cpu utilization across cluster
        </section>

        <!--
        <section data-markdown>
          ## capacity options
          * retention: 1TB/week == roughly 150 days
          * cpu usage: can probably handle 10x more load
        </section>
        -->
        <!-- }}} -->
              
        <section data-markdown>
          <img src="images/logstash.png" class="plain full left">

          <h3>So, about logstash.</h3>

          <p>how can it help you?</p>

        </section>

        <!-- the agent and plugins {{{ -->
        <section data-markdown>
          ## the agent

          inputs | filters | outputs
        </section>

        <section data-markdown>
          ## inputs

          where logs come from.
        </section>

        <section data-markdown>
          ## inputs: local

          * files
          * standard input
          * windows eventlog
        </section>

        <section>
          <h2> inputs: network</h2>

          <table class="list">
            <tr>
              <td> gemfire </td>
              <td> irc </td>
            </tr> <tr>
              <td> rabbitmq </td>
              <td> redis </td>
            </tr> <tr>
              <td> relp </td>
              <td> stomp </td>
            </tr> <tr>
              <td> syslog </td>
              <td> tcp and udp </td>
            </tr> <tr>
              <td> websockets </td>
              <td> xmpp </td>
            </tr>
          </table>
        </section>

        <section data-markdown>
          ## inputs: external

          * Heroku
          * Amazon SQS
          * Twitter Stream API
          * Drupal DBLog
        </section>

        <section data-markdown>
          ## filters

          processing events for awesome
        </section>

        <section data-markdown>
          ## filters: common parsing

          * grok
          * date 
          * grep
          * multiline
        </section>

        <section data-markdown>
          ## filters: complex parsing
          * key=value things="like this"
          * { "json": "parsing" }
          * &lt;xml parsing="true" /&gt;
          * csv,parsing,enabled
          * also=have&amp;url=parsing
        </section>

        <section data-markdown>
          ## filters: improve event data

          * geoip lookups
          * user agent parsing
          * syslog decoding
          * dns lookups
          * zeromq call outs
        </section>

        <section data-markdown>
          ## filters: modify events

          * mutate
          * anonymize
          * translate
        </section>

        <section data-markdown>
          ## outputs

          where events go
        </section>

        <section data-markdown>
          ## outputs: metrics

          * boundary
          * circonus
          * cloudwatch
          * datadog
          * ganglia
          * graphite
          * librato
          * opentsdb
          * riemann
        </section>

        <section data-markdown>
          ## outputs: storage
          * elasticsearch
          * file
          * mongodb
          * redis
          * riak
        </section>

        <section data-markdown>
          ## outputs: monitor &amp; report
          * nagios
          * email
          * pagerduty
          * zabbix
          * irc
        </section>
        <!-- }}} -->

        <!-- deployment models {{{ -->
        <section>
          <h3> simple standalone </h3> 

          <table class="inner-border">
            <tr>
              <th> inputs </th>
              <th> filters </th>
              <th> outputs </th>
            </tr>
            <tr>
              <td> 
                /var/log/messages <br>
                /var/log/apache/access.log <br>
                /var/log/mysql/slow.log <br>
              </td>
              <td> 
                grok <br>
                date <br>
                multiline <br>
                anonymize <br>
              </td>
              <td>
                elasticsearch <br>
                ops irc channel <br>
              </td>
            </tr>
            <!--
            <tr>
              <td colspan="3">
                Summary: read files, parse with filters, send to elasticsearch
              </td>
            </tr>
            -->
          </table>
        </section>

        <section data-markdown>
          ## scale out?

          * expand on inputs|filters|outputs
          * "inputs" are your business machines
          * "filters" are a processing tier
          * "outputs" are a storage and integration tier
        </section>

        <section>
          <h3> tiered </h3> 

          <table class="inner-border">
            <tr>
              <th> inputs </th>
              <th> filters </th>
              <th> outputs </th>
            </tr>
            <tr>
              <td> 
                frontends <br>
                databases <br>
                routers <br>
              </td>
              <td> 
                parse <br>
                anonymize <br>
              </td>
              <td>
                elasticsearch <br>
                graphite <br>
                nagios <br>
                live tail <br>
              </td>
              <tr>
                <td colspan="3"></td>
              </tr>
            </tr>
          </table>

          <ul>
            <li class="fragment"> inputs are your business machines
            <li class="fragment"> filters are machines that processes events
            <li class="fragment"> outputs are machines that store events
          </ul>
        </section>

        <section>
          <img src="images/logstash-and-metrics.png" class="plain">

          <p>
          [image made by Rashid Khan]
          </p>
        </section>
        <!-- }}} -->

        <!-- examples {{{ -->
        <section data-markdown>
          ## examples
        </section>
        <!-- }}} -->

        <section data-markdown>
          ## extendable 
          (>100 plugins)
        </section>

        <section data-markdown>
          ## community
          * newbies have a bad time? It's a bug.
          * communication: irc, mailing list
          * book: http://www.logstashbook.com/
          * tips/tricks: http://cookbook.logstash.net/
          * extra goodness: kibana, logstash-cli, puppet modules, chef cookbook
        </section>

        <section data-markdown>
          ## project metrics
          * 18000 unique monthly visitors to logstash.net 
          * 736 users on logstash-users@googlegroups.com
          * 540 users on logstash.jira.com
          * 275 folks in #logstash on freenode IRC
          * 130 code contributors
        </section>
      </div>

    </div>

    <script src="lib/js/head.min.js"></script>
    <script src="js/reveal.min.js"></script>

    <script>

      // Full list of configuration options available here:
      // https://github.com/hakimel/reveal.js#configuration
      Reveal.initialize({
        controls: true,
        progress: true,
        history: true,
        center: false,

        theme: Reveal.getQueryHash().theme || "night-jls", // available themes are in /css/theme
        transition: Reveal.getQueryHash().transition || 'fade', // default/cube/page/concave/zoom/linear/fade/none

        // Optional libraries used to extend on reveal.js
        dependencies: [
          { src: 'lib/js/classList.js', condition: function() { return !document.body.classList; } },
          { src: 'plugin/markdown/showdown.js', condition: function() { return !!document.querySelector( '[data-markdown]' ); } },
          { src: 'plugin/markdown/markdown.js', condition: function() { return !!document.querySelector( '[data-markdown]' ); } },
          { src: 'plugin/highlight/highlight.js', async: true, callback: function() { hljs.initHighlightingOnLoad(); } },
          { src: 'plugin/zoom-js/zoom.js', async: true, condition: function() { return !!document.body.classList; } },
          { src: 'plugin/notes/notes.js', async: true, condition: function() { return !!document.body.classList; } }
          // { src: 'plugin/remotes/remotes.js', async: true, condition: function() { return !!document.body.classList; } }
        ]
      });

    </script>

  </body>
</html>
